{% extends "base.html" %}
{% block title %}Course Management{% endblock %}

{% block content %}
<div class="container mt-5">
  <h1 class="mb-4">Course Management</h1>

  <h4>Create a New Course</h4>
  <form method="POST" class="mb-5">
    {{ form.hidden_tag() }}

    <div class="mb-3">
      {{ form.title.label(class="form-label") }}
      {{ form.title(class="form-control") }}
    </div>

    <div class="mb-3">
      {{ form.teacher.label(class="form-label") }}
      {{ form.teacher(class="form-control") }}
    </div>

    <div class="mb-3">
      {{ form.time.label(class="form-label") }}
      {{ form.time(class="form-control") }}
    </div>

    <div class="mb-3">
      {{ form.capacity.label(class="form-label") }}
      {{ form.capacity(class="form-control") }}
    </div>

    {{ form.submit(class="btn btn-primary") }}
  </form>

  <hr>

  <h4>Existing Courses</h4>
  <table class="table table-bordered">
    <thead class="table-light">
      <tr>
        <th>Title</th>
        <th>Teacher</th>
        <th>Time</th>
        <th>Capacity</th>
        <th>Enrolled</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for course in courses %}
      <tr>
        <td>
          <a href = "{{ url_for('course_grades',course_id = course.id) }}">{{course.title}}</a>
        </td>
        <td>{{ course.teacher }}</td>
        <td>{{ course.time }}</td>
        <td>{{ course.capacity }}</td>
        <td>{{ course.enrolled_students|length }}</td>
        <td>
          <button class="btn btn-sm btn-outline-secondary" onclick="openEditModal({{ course.id }}, '{{ course.title }}', '{{ course.teacher }}', '{{ course.time }}', {{ course.capacity }})">
            Edit
          </button>
          <form action="{{ url_for('delete_course', course_id=course.id) }}" method="post" style="display:inline;">
            <button class="btn btn-sm btn-outline-danger" type="submit" onclick="return confirm('Are you sure?');">Delete</button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

{% include 'edit_modal.html' %}
{% endblock %}